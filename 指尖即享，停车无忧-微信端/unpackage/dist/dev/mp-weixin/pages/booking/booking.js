(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/booking/booking"],{137:function(e,n,t){"use strict";(function(e,n){var r=t(4);t(26);r(t(25));var o=r(t(138));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t(1)["default"],t(2)["createPage"])},138:function(e,n,t){"use strict";t.r(n);var r=t(139),o=t(141);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);t(143);var i,u=t(32),s=Object(u["default"])(o["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],i);s.options.__file="pages/booking/booking.vue",n["default"]=s.exports},139:function(e,n,t){"use strict";t.r(n);var r=t(140);t.d(n,"render",(function(){return r["render"]})),t.d(n,"staticRenderFns",(function(){return r["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return r["recyclableRender"]})),t.d(n,"components",(function(){return r["components"]}))},140:function(e,n,t){"use strict";var r;t.r(n),t.d(n,"render",(function(){return o})),t.d(n,"staticRenderFns",(function(){return i})),t.d(n,"recyclableRender",(function(){return a})),t.d(n,"components",(function(){return r}));var o=function(){var e=this,n=e.$createElement;e._self._c},a=!1,i=[];o._withStripped=!0},141:function(e,n,t){"use strict";t.r(n);var r=t(142),o=t.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);n["default"]=o.a},142:function(e,n,t){"use strict";(function(e,r){var o=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(t(115)),i=o(t(117)),u=o(t(87)),s=t(88),c={data:function(){return{bookIng:[{id:0,name:"车位一",booking:!0},{id:1,name:"车位二",booking:!1},{id:2,name:"车位三",booking:!1},{id:3,name:"车位四",booking:!0}],userBookingData:[],userInfo:{username:"",password:"",email:""},getBookingUrl:"http://127.0.0.1:8081/car/getUserBooking?",getUserDataUrl:"http://127.0.0.1:8081/user/getUserInfo",cancelBookingUrl:"http://127.0.0.1:8081/car/cancel?",userLoginStatus:!1}},methods:{cancelBooking:function(n){var t=this;return(0,i.default)(a.default.mark((function r(){var o,i,u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={id:"",phone:""},i={},r.next=4,t.dealLoginUser();case 4:return u="".concat(t.cancelBookingUrl,"id=").concat(n.id,"&phone=").concat(t.userInfo.username),r.next=7,t.requestData(u,"GET",{});case 7:i=r.sent,console.log(u),i.code?(console.log(i),o.id=n.id,o.phone=t.userInfo.username,e.$emit("handleBookingEvent",o),e.showToast({title:"取消成功",icon:"success"}),e.$emit("unpdateDataBooking"),e.redirectTo({url:"/pages/booking/booking"})):e.showToast({title:i.msg,icon:"error"});case 10:case"end":return r.stop()}}),r)})))()},requestData:function(n,t,r){return new Promise((function(o,a){e.request({url:n,method:t,data:r,header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){o(e.data)},fail:function(){a(0)}})}))},getUserBooking:function(){var e=this;return(0,i.default)(a.default.mark((function n(){var t,r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t={},e.userBookingData=[],r=e.getBookingUrl+"phone="+e.userInfo.username,n.next=5,e.requestData(r,"GET",{});case 5:t=n.sent,e.userBookingData=t.data,console.log(r);case 8:case"end":return n.stop()}}),n)})))()},dealLoginUser:function(){var n=this;return(0,i.default)(a.default.mark((function t(){var r,o;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getStorageSync("userInfo");case 2:if(r=t.sent,""!=r){t.next=10;break}return n.userLoginStatus=!1,e.showToast({title:"请先登录",icon:"error"}),e.redirectTo({url:"/pages/login/login"}),t.abrupt("return");case 10:return n.userInfo=r,t.next=13,n.requestData(n.getUserDataUrl,"POST",r);case 13:o=t.sent,o.code?n.userLoginStatus=!0:e.showToast({title:"用户信息错误",icon:"error"});case 15:case"end":return t.stop()}}),t)})))()},connectAliYun:function(){var e=this,n=(this.date,s.getAliyunIotMqttClient({productKey:e.data.aliyunInfo.productKey,deviceName:e.data.aliyunInfo.deviceName,deviceSecret:e.data.aliyunInfo.deviceSecret,regionId:e.data.aliyunInfo.regionId,port:e.data.aliyunInfo.port}));console.log(1111);var t="wxs://"+n.host;this.data.options.clientId=n.clientId,this.data.options.password=n.password,this.data.options.username=n.username,this.data.client=u.default.connect(t,this.data.options),this.data.client=u.default.connect(t,this.data.options),this.data.client.on("connect",(function(e){r.showToast({title:"连接成功"}),console.log("连接成功")}))}},onLoad:function(){var n=this;return(0,i.default)(a.default.mark((function t(){var r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=n,t.next=3,n.dealLoginUser();case 3:return t.next=5,n.getUserBooking();case 5:e.$on("breakBookingData",(function(){r.getUserBooking()}));case 6:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){var e=this;return(0,i.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.dealLoginUser();case 2:return n.next=4,e.getUserBooking();case 4:case"end":return n.stop()}}),n)})))()}};n.default=c}).call(this,t(2)["default"],t(1)["default"])},143:function(e,n,t){"use strict";t.r(n);var r=t(144),o=t.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);n["default"]=o.a},144:function(e,n,t){}},[[137,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/booking/booking.js.map