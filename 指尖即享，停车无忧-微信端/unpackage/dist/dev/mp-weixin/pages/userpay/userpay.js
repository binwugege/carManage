(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/userpay/userpay"],{153:function(e,t,r){"use strict";(function(e,t){var n=r(4);r(26);n(r(25));var a=n(r(154));e.__webpack_require_UNI_MP_PLUGIN__=r,t(a.default)}).call(this,r(1)["default"],r(2)["createPage"])},154:function(e,t,r){"use strict";r.r(t);var n=r(155),a=r(157);for(var c in a)["default"].indexOf(c)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(c);r(159);var o,u=r(32),i=Object(u["default"])(a["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],o);i.options.__file="pages/userpay/userpay.vue",t["default"]=i.exports},155:function(e,t,r){"use strict";r.r(t);var n=r(156);r.d(t,"render",(function(){return n["render"]})),r.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(t,"components",(function(){return n["components"]}))},156:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"render",(function(){return a})),r.d(t,"staticRenderFns",(function(){return o})),r.d(t,"recyclableRender",(function(){return c})),r.d(t,"components",(function(){return n}));try{n={uniPopup:function(){return r.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(r.bind(null,161))}}}catch(u){if(-1===u.message.indexOf("Cannot find module")||-1===u.message.indexOf(".vue"))throw u;console.error(u.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement;e._self._c},c=!1,o=[];a._withStripped=!0},157:function(e,t,r){"use strict";r.r(t);var n=r(158),a=r.n(n);for(var c in n)["default"].indexOf(c)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(c);t["default"]=a.a},158:function(e,t,r){"use strict";(function(e){var n=r(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(115)),c=n(r(117)),o=r(98),u={data:function(){return{carOrderData:{},isCarPlate:!1,carPlateData:"",getCarPayUrl:"http://localhost:8081/pay/getOrder",accountPayUrl:"http://localhost:8081/pay/accountOrder",parkingTimer:0}},methods:{payOrder:function(){this.$refs.carOrder.open()},close:function(){this.$refs.carOrder.close()},confirm:function(){e.showToast({title:"支付成功"}),this.$refs.carOrder.close()},sendAxios:function(t,r,n){return new Promise((function(a,c){e.request({url:t,data:n,method:r,header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){a(e.data)},fail:function(e){c(e.data)}})}))},selectOrder:function(){var t=this;return(0,c.default)(a.default.mark((function r(){var n,c;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={},c="".concat(t.getCarPayUrl,"?carPlate=").concat(t.carPlateData),r.next=4,t.sendAxios(c,"GET","");case 4:if(n=r.sent,t.isCarPlate=!1,n.code){r.next=9;break}return e.showToast({title:"请求错误"}),r.abrupt("return");case 9:if(!n.data.isAccount){r.next=11;break}return r.abrupt("return");case 11:t.isCarPlate=!0,t.carOrderData=n.data,t.dealParkingTImer(t.carOrderData);case 14:case"end":return r.stop()}}),r)})))()},dealParkingTImer:function(e){var t=0,r=[],n=[],a=e.startTimer,c=e.endTimer;if(""==c){var u=new Date,i=(0,o.formatTime)(u).parkingTimer,s=i.join("-");this.carOrderData.endTimer=s,c=s}r=a.split("-"),n=c.split("-"),r=r.map(Number),n=n.map(Number),t=24*(n[2]-r[2])*60+(60*n[3]+n[4])-(60*r[3]+r[4]),this.parkingTimer=t,console.log(t)},accountOrder:function(){var t=this;return(0,c.default)(a.default.mark((function r(){var n;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n="".concat(t.accountPayUrl,"?carPlate=").concat(t.carPlateData),r.next=3,t.sendAxios(n,"GET","");case 3:if(data=r.sent,data.code){r.next=7;break}return e.showToast({title:"结算失败",icon:"error"}),r.abrupt("return");case 7:return e.showToast({title:"支付成功",icon:"success"}),r.abrupt("return");case 9:case"end":return r.stop()}}),r)})))()}},onLoad:function(e){e.carPlate&&(this.carPlateData=e.carPlate,this.selectOrder())}};t.default=u}).call(this,r(2)["default"])},159:function(e,t,r){"use strict";r.r(t);var n=r(160),a=r.n(n);for(var c in n)["default"].indexOf(c)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(c);t["default"]=a.a},160:function(e,t,r){}},[[153,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/userpay/userpay.js.map