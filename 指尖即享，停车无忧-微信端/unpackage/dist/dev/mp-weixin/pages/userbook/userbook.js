(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/userbook/userbook"],{145:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26);r(n(25));var o=r(n(146));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n(1)["default"],n(2)["createPage"])},146:function(e,t,n){"use strict";n.r(t);var r=n(147),o=n(149);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n(151);var u,i=n(32),s=Object(i["default"])(o["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],u);s.options.__file="pages/userbook/userbook.vue",t["default"]=s.exports},147:function(e,t,n){"use strict";n.r(t);var r=n(148);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},148:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return o})),n.d(t,"staticRenderFns",(function(){return u})),n.d(t,"recyclableRender",(function(){return a})),n.d(t,"components",(function(){return r}));var o=function(){var e=this,t=e.$createElement;e._self._c},a=!1,u=[];o._withStripped=!0},149:function(e,t,n){"use strict";n.r(t);var r=n(150),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a},150:function(e,t,n){"use strict";(function(e,r){var o=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(115)),u=o(n(117)),i=o(n(87)),s=n(88),c={data:function(){return{bookIng:[{id:0,name:"车位一",booking:!0},{id:1,name:"车位二",booking:!1},{id:2,name:"车位三",booking:!1},{id:3,name:"车位四",booking:!0}],userBookingData:[],userInfo:{username:"",password:"",email:""},getBookingUrl:"http://127.0.0.1:8081/car/getUserBooking?",getUserDataUrl:"http://127.0.0.1:8081/user/getUserInfo",cancelBookingUrl:"http://127.0.0.1:8081/car/cancel?",userLoginStatus:!1}},methods:{cancelBooking:function(t){var n=this;return(0,u.default)(a.default.mark((function r(){var o,u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={},r.next=3,n.dealLoginUser();case 3:return u="".concat(n.cancelBookingUrl,"id=").concat(t.id,"&phone=").concat(n.userInfo.username),r.next=6,n.requestData(u,"GET",{});case 6:o=r.sent,console.log(u),o.code?(e.showToast({title:"取消成功",icon:"success"}),e.redirectTo({url:"/pages/userbook/userbook"})):e.showToast({title:o.msg,icon:"error"});case 9:case"end":return r.stop()}}),r)})))()},requestData:function(t,n,r){return new Promise((function(o,a){e.request({url:t,method:n,data:r,header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){o(e.data)},fail:function(){a(0)}})}))},getUserBooking:function(){var e=this;return(0,u.default)(a.default.mark((function t(){var n,r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},e.userBookingData=[],r=e.getBookingUrl+"phone="+e.userInfo.username,t.next=5,e.requestData(r,"GET",{});case 5:n=t.sent,e.userBookingData=n.data,console.log(r);case 8:case"end":return t.stop()}}),t)})))()},dealLoginUser:function(){var t=this;return(0,u.default)(a.default.mark((function n(){var r,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getStorageSync("userInfo");case 2:if(r=n.sent,""!=r){n.next=10;break}return t.userLoginStatus=!1,e.showToast({title:"请先登录",icon:"error"}),e.redirectTo({url:"/pages/login/login"}),n.abrupt("return");case 10:return t.userInfo=r,n.next=13,t.requestData(t.getUserDataUrl,"POST",r);case 13:o=n.sent,o.code?t.userLoginStatus=!0:e.showToast({title:"用户信息错误",icon:"error"});case 15:case"end":return n.stop()}}),n)})))()},connectAliYun:function(){var e=this,t=(this.date,s.getAliyunIotMqttClient({productKey:e.data.aliyunInfo.productKey,deviceName:e.data.aliyunInfo.deviceName,deviceSecret:e.data.aliyunInfo.deviceSecret,regionId:e.data.aliyunInfo.regionId,port:e.data.aliyunInfo.port}));console.log(1111);var n="wxs://"+t.host;this.data.options.clientId=t.clientId,this.data.options.password=t.password,this.data.options.username=t.username,this.data.client=i.default.connect(n,this.data.options),this.data.client=i.default.connect(n,this.data.options),this.data.client.on("connect",(function(e){r.showToast({title:"连接成功"}),console.log("连接成功")}))}},onLoad:function(){var e=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dealLoginUser();case 2:return t.next=4,e.getUserBooking();case 4:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){var e=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dealLoginUser();case 2:return t.next=4,e.getUserBooking();case 4:case"end":return t.stop()}}),t)})))()}};t.default=c}).call(this,n(2)["default"],n(1)["default"])},151:function(e,t,n){"use strict";n.r(t);var r=n(152),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a},152:function(e,t,n){}},[[145,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/userbook/userbook.js.map